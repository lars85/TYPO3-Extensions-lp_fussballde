plugin.tx_lpfussballdef4x {
	# Includes a list of Javascript files (separated by new lines)
	includeJs = COA
	includeJs {
		10 = LOAD_REGISTER
		10 {
			# Schl√ºssel
			lpFussballdeF4x_schluessel.cObject = CASE
			lpFussballdeF4x_schluessel.cObject {
				key.data = getenv:HTTP_HOST
				# Replace all points with underscore characters in domain
				key.stdWrap.replacement.10 {
					search = .
					replace = _
				}
				/*
				domain_de = TEXT
				domain_de.value = ABCD..
				*/
				default = TEXT
				default.value = {$plugin.tx_lpfussballdef4x.settings.attributes.schluessel}
			}
			lpFussballdeF4x_schluessel.override.field = schluessel
		}

		20 = TEXT
		20 {
			data = register:lpFussballdeF4x_schluessel
			wrap = http://ergebnisdienst.fussball.de/static/egm//js/egmWidget.js?schluessel=|
			append = TEXT
			append.char = 10
		}

		100 = RESTORE_REGISTER
	}

	renderObj = COA
	renderObj {
		10 = LOAD_REGISTER
		10 {
			lpFussballdeF4x_id = {field:extensionKeyWithoutUnderl}_c{field:contentUid}
			lpFussballdeF4x_id.insertData = 1

			# Wettbewerb
			lpFussballdeF4x_wettbewerbId = {$plugin.tx_lpfussballdef4x.settings.attributes.wettbewerbId}
			lpFussballdeF4x_wettbewerbId.override.field = wettbewerbId

			# Mandant
			lpFussballdeF4x_mandantId = {$plugin.tx_lpfussballdef4x.settings.attributes.mandantId}
			lpFussballdeF4x_mandantId.override.field = mandantId

			# Display
			lpFussballdeF4x_display = {$plugin.tx_lpfussballdef4x.settings.attributes.display}
			lpFussballdeF4x_display.override.field = display
		}

		# Renders the content of the plugin
		20 = COA
		20 {
			stdWrap.dataWrap = <div class="tx-{field:extensionKeyWithoutUnderl}-pi1 tx-{field:extensionKeyWithoutUnderl}-display{register:lpFussballdeF4x_display}">|</div>

			# Error messages
			20 = COA
			20 {
				stdWrap.wrap = <ul class="flash-messages">|</ul>
				stdWrap.required = 1

				10 = TEXT
				10 {
					wrap = <li class="error">|</li>
					noTrimWrap = |Missing Attribute: ||
					value = wettbewerbId
					if.isFalse.data = register:lpFussballdeF4x_wettbewerbId
				}
				20 < .10
				20 {
					value = mandantId
					if.isFalse.data = register:lpFussballdeF4x_mandantId
				}
				30 < .10
				30 {
					value = display
					if.isFalse.data = register:lpFussballdeF4x_display
				}
			}

			# Main div container with loading text
			30 = TEXT
			30 {
				dataWrap = <div id="{register:lpFussballdeF4x_id}">|</div>
				data = LLL:EXT:lp_fussballde_f4x/Resources/Private/Language/locallang.xlf:loading
			}

			# Source
			40 = TEXT
			40 {
				wrap = <div class="source">|</div>
				data = LLL:EXT:lp_fussballde_f4x/Resources/Private/Language/locallang.xlf:source
			}

			# Javascript
			50 = COA
			50 {
				wrap = <script type="text/javascript">|</script>

				10 = TEXT
				10.value = var {register:lpFussballdeF4x_id} = new fussballdeAPI();
				10.insertData = 1
				//10.append = TEXT
				//10.append.char = 10

				20 < .10
				20.value = {register:lpFussballdeF4x_id}.setzeWettbewerb('{register:lpFussballdeF4x_wettbewerbId}');

				30 < .10
				30.value = {register:lpFussballdeF4x_id}.setzeMandant('{register:lpFussballdeF4x_mandantId}');

				40 = CASE
				40 {
					stdWrap.dataWrap = {register:lpFussballdeF4x_id}.zeige|('{register:lpFussballdeF4x_id}');
					key.data = register:lpFussballdeF4x_display

					1 = TEXT
					1.value = Begegnungen

					2 = TEXT
					2.value = Tabelle
				}
			}
		}

		/*
		28 = TEXT
		28.data = debug:data
		29 = TEXT
		29.data = debug:register
		*/

		30 = RESTORE_REGISTER
	}

}

plugin.tx_lpfussballdef4x._CSS_DEFAULT_STYLE (
	/* Hide elements */
	.tx-lpfussballdef4x-pi1 #fussballdeAPI,
	.tx-lpfussballdef4x-pi1 .egmTab,
	.tx-lpfussballdef4x-pi1 .egmIconMatchReport,
	.tx-lpfussballdef4x-pi1 .egmMatchMediaLink,
	.tx-lpfussballdef4x-display2 .egmSnippetControl,
	.tx-lpfussballdef4x-pi1 iframe {
		display: none !important;
		height: 0 !important;
	}

	/* 100% width for the table */
	.tx-lpfussballdef4x-pi1 div.egmMain {
		width: 100% !important;
	}

	/* Background for controls container */
	.tx-lpfussballdef4x-pi1 .egmSnippetControl {
		background: #CCCCCC;
	}

	/* Source */
	.tx-lpfussballdef4x-pi1 > .source {
		color: #CCCCCC;
		text-align: right;
	}
)